---
layout: post
title: "Week12_MQTT"
subtitle: MQTT
thumbnail-img: "https://user-images.githubusercontent.com/63178658/239456247-d47a7325-e5f5-4940-a27e-1e463ddff17c.png"
tag: Smart_Device
---

<br><br>
<br><br>
tcp / udp? 차이
## 1️⃣ MQTT와 Node-red 연결 
<hr/>
<br>
<br><br>
### 1. 아래 링크에서 Host / Port / ClientID 확인  <br><br>
[MQTT_Client_URL](https://www.hivemq.com/demos/websocket-client)
<img src = "https://user-images.githubusercontent.com/63178658/239456247-d47a7325-e5f5-4940-a27e-1e463ddff17c.png"/><br><br>
<br><br>
<br><br>
### 2. Node-red에 아래와 같이 노드 설정 <br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239453607-f6647bc2-6c85-4e2b-a3ac-84db77512ea7.png"/><br><br>
<br><br>
<br><br>



### 3. mqtt.in 노드 설정<br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239453608-656829f9-40ff-4b85-a717-5f46bb35076e.png"/><br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239453611-50849ada-7217-4a77-88f7-fc0c4cbbf55f.png"/><br><br>
#### 설정 후 배포
<br><br>
<br><br>

### 4. 다시 MQTT Client에서 연결 시도<br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239456252-6d47cfdf-e54a-42b9-96da-04f685491f89.png"/><br><br>
#### 연결이 완료 되면 아래와 같이 "connected"와 버튼이 "Disconnect"로 변경 됨
<img src = "https://user-images.githubusercontent.com/63178658/239455190-c9c4d3b6-426d-4f89-a5e9-22e914dc063e.png"/><br><br>
<br><br>
<br><br>



## 2️⃣ MQTT Topic 설정
<hr/>
<br>
<br><br>
### 1. 아래 순서로 msg 확인  <br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239456958-ba3e742b-a102-4e81-8b90-6c88f6276fb0.png"/><br><br>
<br><br>
<br><br>


### 2. Subscriptions에서 temp / humi topic 설정  <br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239456241-27163fee-b28b-4dcb-9079-7ad29289dd4f.png"/><br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239453598-110f8d1f-d416-4ad3-9b1d-13cb9f9e1bef.png"/><br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239453586-bc41720c-7afe-48e1-a9da-93292e90f6ef.png"/><br><br>

<br><br>
<br><br>
### 3. Node-red에서도 topic 설정<br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239454596-bc0b7ef3-9976-4422-b63b-2573992cf1bf.png"/><br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239454600-597abe05-df62-4ea2-ac55-9a043ea7108a.png"/><br><br>
<br><br>
<br><br>

## 3️⃣ esp32 코드 업로드 
<hr/>
<br>
<br><br>

### 1. 아래 코드 참고하여 코드 수정 후 업로드  <br><br>
<script src="https://gist.github.com/yejin0509/90d5c41f114c36cb168e25472fcd14b4.js"></script><br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239455198-b4bb976e-f8e8-4a67-977f-bd29a9fe14b8.png"/><br><br>
<br><br>
<br><br>
<br><br>

### 2. 시리얼 모니터에서 온습도 확인   <br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239453585-65ea2b48-9a2f-4936-b5f5-ddc27910b70e.png"/><br><br>
<br><br>
<br><br>
<br><br>

### 3. UI 확인  <br><br>
<img src = "https://user-images.githubusercontent.com/63178658/239453601-430fd41c-7ff5-4be4-8753-be8317d4432c.png"/><br><br>
<br><br>
<br><br>
